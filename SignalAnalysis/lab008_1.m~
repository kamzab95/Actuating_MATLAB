m = 2;
c = 0.3;
k = 1000;

t = tout;
a = acc.Data;
v = velocity.Data;
Pd = P.data;

matrix = zeros(3);
pmat = zeros(3,1);
for j=1:1:length(p)   
   ax = a(j);
   vx = v(j);
   tx = t(j);
   Px = Pd(j);
   
   matrix(1,1) = matrix(1,1) + ax^2;
   matrix(1,2) = matrix(1,2) + ax * vx;
   matrix(1,3) = matrix(1,3) + ax * tx;
   matrix(2,1) = matrix(2,1) + ax * vx;
   matrix(2,2) = matrix(2,2) + vx^2;
   matrix(2,3) = matrix(2,3) + vx * tx;
   matrix(3,1) = matrix(3,1) + ax * tx;
   matrix(3,2) = matrix(3,2) + vx * tx;
   matrix(3,3) = matrix(3,3) + tx^2;
   
   pmat(1) = pmat(1) + Px * ax;
   pmat(2) = pmat(2) + Px * vx;
   pmat(3) = pmat(3) + Px * tx;
    
end

sol = matrix\pmat;

